---
layout: post
title: "Descubre CALCDATE: Simplificando el C√°lculo y Manipulaci√≥n de Fechas en Navision y Business Central"
summary: "En este art√≠culo, exploramos la poderosa funci√≥n CALCDATE, una herramienta esencial en Navision y Business Central para realizar c√°lculos avanzados con fechas. Simplifica la gesti√≥n del tiempo en tus proyectos y operaciones diarias con CALCDATE."
author: "Esteve Sanpons"
date: "2023-09-17 04:00:00 +0200"
#cSpell:disable
category: ["Navision", "Business_Central"]
thumbnail: /assets/img/posts/calcdate/imagen01.jpg
permalink: /blog/calcdate/
custom_type: Blog
publised: false
#cSpell:enable
---

¬°Hola a todos de nuevo! En esta ocasi√≥n, quiero compartir con vosotros una funcionalidad incre√≠ble pero a menudo pasada por alto en Navision y Business Central: ¬°c√≥mo calcular fechas de forma sencilla y efectiva! Es esencial comprender esta capacidad, ya que puede facilitar en gran medida el trabajo con fechas y permitirnos realizar operaciones avanzadas con ellas.

Hoy vamos a sumergirnos en el tema de la funci√≥n CALCDATE, una poderosa herramienta que nos permitir√° calcular nuevas fechas a partir de una fecha inicial. Antes de continuar, pod√©is consultar la documentaci√≥n oficial sobre esta funci√≥n en el siguiente [Link](https://learn.microsoft.com/en-us/dynamics-nav/calcdate-function--date-)

<br>

¬øEst√°is listos para desentra√±ar los secretos detr√°s de CALCDATE? Pues, vamos manos a la obra üò§

<br>

La estructura base de la funci√≥n CALCDATE es la siguiente:

```javascript

NewDate := CALCDATE(DateExpression [, Date])

```

<br><br>

En esta estructura, encontramos dos par√°metros: uno obligatorio, llamado DateExpression, y otro opcional, que se refiere a la fecha desde la cual queremos realizar nuestros c√°lculos. Si no se proporciona esta √∫ltima fecha, la funci√≥n tomar√° autom√°ticamente la fecha del sistema.

Ahora, echemos un vistazo a las expresiones que podemos utilizar con CALCDATE.

En primer lugar, podemos sumar o restar d√≠as utilizando los s√≠mbolos "+" y "‚Äì". Adem√°s, podemos utilizar una numeraci√≥n secuencial, comenzando desde 1 y aumentando seg√∫n nuestras necesidades.

Por √∫ltimo, tenemos las unidades de tiempo que podemos emplear:

-   D: D√≠a
-   WD: D√≠a laboral
-   W: Semana
-   M: Mes
-   Q: Trimestre
-   Y: A√±o

<br>

Si deseamos referirnos a la unidad de tiempo actual, simplemente a√±adiremos el prefijo "C" antes de la unidad correspondiente.

Lo s√©, puede resultar un poco confuso al principio, pero no os preocup√©is. Vamos a ver un ejemplo para aclarar las cosas.

Imaginad que queremos obtener la fecha del primer d√≠a de la semana actual, es decir, el lunes de esta misma semana. Para lograrlo, simplemente utilizar√≠amos la expresi√≥n -CW, lo que nos devolver√≠a la fecha de hoy üôà.

Si, por otro lado, deseamos sumar 2 d√≠as a la fecha de hoy, bastar√≠a con a√±adir +2D a nuestra expresi√≥n.

<br><br>

Perm√≠tidme ahora proporcionar algunos ejemplos adicionales que os ser√°n de utilidad:

-   Final trimestre +1 mes -10 d√≠as: <CQ+1M-10D>
-   Menos un a√±o: <-1Y>
-   Final de mes: <CM>
-   Inicio del mes: <-CM>
-   Inicio de semana: <-CW>
-   Final de a√±o: <CY>
-   Principio de a√±o: <-CY>
-   Principio de mes del mes que viene: <-CM+1M>
-   Principio de a√±o del a√±o pasado: <-CY-1Y>

<br><br>

Espero que estos ejemplos os hayan ayudado a comprender mejor la versatilidad de la funci√≥n CALCDATE.

Ahora bien, para que todo quede a√∫n m√°s claro, os he preparado algunos ejemplos en c√≥digo utilizando CALCDATE:

```javascript

codeunit 50000 "calcdate"
{

    procedure FinalTrimestre() NewDate: Boolean
    begin
        NewDate := CalcDate('<CQ>');
    end;

    procedure MenosUnYear(ValueDate: Date) NewDate: Boolean
    begin
        NewDate := CalcDate('<-1Y>', ValueDate);
    end;

    procedure UltimoDiaDelMesActual() NewDate: Boolean
    begin
        NewDate := CalcDate('<CM>');
    end;
}

```

<br><br>

En resumen, la funci√≥n CALCDATE en Navision y Business Central es una herramienta poderosa para calcular y manipular fechas de forma efectiva. Con expresiones como suma y resta de d√≠as, numeraci√≥n secuencial y unidades de tiempo, podemos realizar c√°lculos avanzados. Es √∫til para obtener fechas espec√≠ficas, como el √∫ltimo d√≠a del trimestre o el primer d√≠a del mes siguiente.

<br><br>

Como siempre, podr√©is ver el ejemplo entero en el [Link](https://github.com/Esanpons/ejemplos-blog/tree/main/AL/CALCDATE)

<br>

Si√©ntete libre de expresar tus puntos de vista y preguntas. Deseo que encuentres este contenido valioso e inspirador, ¬°y espero verte en pr√≥ximas actualizaciones!
